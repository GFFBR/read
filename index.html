<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Site de Estatísticas</title>
    <!-- Adicionando um pouco de estilo para uma aparência mais limpa -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            text-align: center;
            background-color: #f4f4f9;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 500px;
        }
        h1 {
            color: #1a1a1a;
        }
        #result {
            margin-top: 20px;
            font-size: 1.1em;
            color: #555;
        }
        #country-info {
            font-size: 1.3em;
            font-weight: bold;
            color: #0056b3; /* Um azul mais forte */
            display: block;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bem-vindo(a)!</h1>
        <p>Analisando sua conexão para fins de estatística...</p>
        <p id="result">Detectando seu país...</p>
    </div>

    <script>
        // Função assíncrona para buscar os dados de geolocalização
        async function detectAndLogCountry() {
            const resultElement = document.getElementById('result');

            try {
                // 1. Usando uma API diferente e confiável (freeipapi.com)
                // Esta API tem uma boa política de CORS, funcionando bem em arquivos locais.
                const response = await fetch('https://freeipapi.com/api/json/');

                // 2. Verificando se a resposta da rede foi bem-sucedida
                if (!response.ok) {
                    // Se a resposta não for 'ok' (ex: erro 404, 500), lançamos um erro.
                    throw new Error(`Erro na rede: Status ${response.status}`);
                }
                const data = await response.json();

                // 3. Extraindo o nome do país da resposta
                const country = data.countryName || 'País Desconhecido';

                // 4. Exibindo o resultado de forma mais clara na página
                resultElement.innerHTML = `Obrigado por visitar! Detectamos que seu acesso é de: <span id="country-info">${country}</span>`;

                // 5. Registrando no console para depuração (o passo antes de salvar em um BD)
                console.log(`País detectado com sucesso: ${country}.`);

            } catch (error) {
                // 6. Se qualquer passo no bloco 'try' falhar, o 'catch' é executado
                console.error('Ocorreu um erro ao detectar o país:', error);
                resultElement.textContent = 'Desculpe, não foi possível detectar sua localização no momento.';
            }
        }

        // Executando a função quando a página termina de carregar
        window.onload = detectAndLogCountry;
    </script>
</body>
</html>

